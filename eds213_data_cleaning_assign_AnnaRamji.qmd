---
title: "EDS 213 Assignment 2: Data Cleaning"
name: "Anna Ramji"
format: html
---



```{r}
#| message: false  

# Libraries
library(tidyverse)

# file names
datadir_raw <- "data/raw/"

datadir_processed <- "data/processed/"

species_file <- "ASDN_Daily_species.csv"

snowsurvey_file <- "ASDN_Snow_survey.csv"
```


Import data

```{r read-in-data}
# Import the species
snowsurvey_clean <- read_csv(file.path(datadir_processed, "snow_cover.csv"))
```


```{r}
# from last class:
# snowsurvey_fixed <- snowsurvey_csv %>% 
#   mutate(Snow_cover = ifelse(Snow_cover == ".", NA, Snow_cover)) %>% 
#   mutate(Snow_cover = ifelse(Snow_cover == "-", NA, Snow_cover)) %>% 
#   mutate(Snow_cover = ifelse(Snow_cover == "n/a", NA, Snow_cover)) %>% 
#   mutate(Snow_cover = ifelse(Snow_cover == "unk", NA, Snow_cover)) %>% 
#   mutate(Snow_cover = ifelse(Snow_cover == "<1", "0", Snow_cover)) %>% 
#   mutate(Snow_cover = as.numeric(Snow_cover)) %>% 
#   mutate(Snow_cover = ifelse(Snow_cover > 100, NA, Snow_cover)) 


#write_csv(snowsurvey_fixed, file.path(datadir_processed, "snow_cover.csv"))

```

# Cleaning Water_cover

```{r}
# explore
snowsurvey_clean %>% 
  count(Water_cover) %>% 
  filter(is.na(as.numeric(Water_cover)))
# looks like there are similar issues with "-", ".", "n/a", "unk" and actual NAs

# snowsurvey_csv %>% 
#   filter(Water_cover == ".")

# it seems like most of these are empty and can be replaced with NA. The same is true for the other symbols and phrases.

snowsurvey_clean_water <- snowsurvey_clean %>% 
  mutate(Water_cover = ifelse(Water_cover == ".", NA, Water_cover)) %>%
  mutate(Water_cover = ifelse(Water_cover == "-", NA, Water_cover)) %>%
  mutate(Water_cover = ifelse(Water_cover == "n/a", NA, Water_cover)) %>%
  mutate(Water_cover = ifelse(Water_cover == "unk", NA, Water_cover)) %>%
  mutate(Water_cover = as.numeric(Water_cover)) 

# > snowsurvey_clean_water %>% filter(Water_cover > 100) # returns 1 entry
# > snowsurvey_clean_water %>% filter(Water_cover < 0) # returns 0 entries

# there is one entry in which Water_cover is 353, Snow_cover is 45, and Land_cover is -298... Total_cover is somehow 100. I think it's possible that they meant to put 35 for Water_cover and 20 for Land_cover, but I can't actually assume that so I'll set it to NA for now.  

snowsurvey_clean_water <- snowsurvey_clean_water %>% 
  mutate(Water_cover = ifelse(Water_cover > 100, NA, Water_cover)) # replace values over 100 with NA 

# glimpse(snowsurvey_clean_water)
# Water_cover is in the proper data type and looks good!
```

## Cleaning Land_cover

```{r}
snowsurvey_clean %>% 
  count(Land_cover) %>% 
  filter(is.na(as.numeric(Land_cover)))

# same issues with "-", "." (585 of these!), "n/a" and "unk".

# snowsurvey_clean %>% 
#   filter(Land_cover == ".") 
# seems to be just NAs as well as the "-"

snowsurvey_clean_land <- snowsurvey_clean_water %>% 
  mutate(Land_cover = ifelse(Land_cover == ".", NA, Land_cover)) %>%
  mutate(Land_cover = ifelse(Land_cover == "-", NA, Land_cover)) %>%
  mutate(Land_cover = ifelse(Land_cover == "n/a", NA, Land_cover)) %>%
  mutate(Land_cover = ifelse(Land_cover == "unk", NA, Land_cover)) %>%
  mutate(Land_cover = as.numeric(Land_cover)) 
  
  
# snowsurvey_clean_land %>% filter(Land_cover > 100) # returns 0 entries
snowsurvey_clean_land %>% filter(Land_cover < 0) # returns 2 entries

# in the following row:
# barr   2011 31-May-… brw3  d10              NA           0       -100 100         abankert NA  
# Land_cover is written as -100. The other two columns are 0 and NA, and the total is 100. I think it is safe to guess that this value is supposed to be + 100.

# in the other row, 
# 2 barr   2011 8-Jun-11 brw5  l4               45          NA       -298 100         jcunnin… NA 
#This is the complicated row from the Water_cover cleaning step. Snow_cover is 45, we turned Water_cover into NA, and Land_cover is -298 while Total_cover is 100. I think it makes the most sense to turn this value into NA.

snowsurvey_clean_land <- snowsurvey_clean_land %>% 
  mutate(Land_cover = ifelse(Land_cover == -100, NA, Land_cover)) %>% 
  mutate(Land_cover = ifelse(Land_cover < 0, NA, Land_cover))

# check to see if these updates worked:
# glimpse(snowsurvey_clean_land) # Land_cover is a double (proper data type)
# snowsurvey_clean_land %>% filter(Land_cover < 0) # returns 0 entries
```

Use the relationship between the three cover columns (Snow, Water, Land) to infer missing values where possible and recompute the Total_cover column


```{r}



```

